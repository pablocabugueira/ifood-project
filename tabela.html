<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tela de Visualização de Dados</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet">
   <link href="css/tabela.css" rel="stylesheet">
</head>
<body>

    <!-- Header -->
    <div class="header">
        <img src="images/ifoodImg.png" alt="Logo">
        <img src="images/user.png" alt="Perfil" class="profile-icon">
    </div>

<div class="titulo">
    <h2>Tela de visualização de dados de envio</h2>
</div>

    <div class="container table-container">
        <!-- Filtros e Botões (lado a lado) -->
        <div class="action-section">
            <div class="filters d-flex">
                <select id="statusFilter" class="form-select w-50 me-2">
                    <option value="todos">Todos</option>
                    <option value="inconsistente">Apenas Inconsistentes</option>
                    <option value="consistente">Apenas Consistentes</option>
                </select>
                <input type="month" id="dateFilter" class="form-control w-50">
            </div>
            <img src="images/excel.png" width="50px">
            <div class="d-flex">
                <button id="importBtn" class="btn btn-custom-import">Importar Excel</button>
                <button id="exportBtn" class="btn btn-custom-export">Exportar Excel</button>
            </div>
            
        </div>

        <!-- Tabela -->
        <div class="table-responsive text-center">
            <table class="table table-striped mx-auto">
                <thead>
                    <tr>
                        <th>N° </th>
                        <th>Identidade da Propriedade</th>
                        <th>Nome do Proprietário</th>
                        <th>Sexo</th>
                        <th>CPF/CNPJ</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody id="dataTable">
                    <tr data-status="consistente">
                        <td>1</td>
                        <td>12345</td>
                        <td>João Silva</td>
                        <td>Masculino</td>
                        <td>123.456.789-00</td>
                        <td>Consistente</td>
                    </tr>
                    <tr data-status="inconsistente">
                        <td>2</td>
                        <td>54321</td>
                        <td>Maria Souza</td>
                        <td>Feminino</td>
                        <td>987.654.321-00</td>
                        <td>Inconsistente</td>
                    </tr>
                    <tr data-status="consistente">
                        <td>3</td>
                        <td>67890</td>
                        <td>Carlos Pereira</td>
                        <td>Masculino</td>
                        <td>321.654.987-00</td>
                        <td>Consistente</td>
                    </tr>
                    <tr data-status="inconsistente">
                        <td>4</td>
                        <td>09876</td>
                        <td>Fernanda Lima</td>
                        <td>Feminino</td>
                        <td>456.789.123-00</td>
                        <td>Inconsistente</td>
                    </tr>
                    <tr data-status="consistente">
                        <td>5</td>
                        <td>34567</td>
                        <td>Ana Costa</td>
                        <td>Feminino</td>
                        <td>789.123.456-00</td>
                        <td>Consistente</td>
                    </tr>
                    <tr data-status="inconsistente">
                        <td>6</td>
                        <td>45678</td>
                        <td>Pedro Oliveira</td>
                        <td>Masculino</td>
                        <td>654.321.987-00</td>
                        <td>Inconsistente</td>
                    </tr>
                    <tr data-status="consistente">
                        <td>7</td>
                        <td>56789</td>
                        <td>Lucas Andrade</td>
                        <td>Masculino</td>
                        <td>123.654.789-00</td>
                        <td>Consistente</td>
                    </tr>
                    <tr data-status="inconsistente">
                        <td>8</td>
                        <td>67891</td>
                        <td>Sandra Costa</td>
                        <td>Feminino</td>
                        <td>654.987.321-00</td>
                        <td>Inconsistente</td>
                    </tr>
                    <tr data-status="consistente">
                        <td>9</td>
                        <td>78901</td>
                        <td>Marcos Alves</td>
                        <td>Masculino</td>
                        <td>321.987.654-00</td>
                        <td>Consistente</td>
                    </tr>
                    <tr data-status="inconsistente">
                        <td>10</td>
                        <td>89012</td>
                        <td>Patrícia Lima</td>
                        <td>Feminino</td>
                        <td>987.321.456-00</td>
                        <td>Inconsistente</td>
                    </tr>
                    <tr data-status="consistente">
                        <td>11</td>
                        <td>90123</td>
                        <td>Renato Silva</td>
                        <td>Masculino</td>
                        <td>123.789.654-00</td>
                        <td>Consistente</td>
                    </tr>
                    <tr data-status="inconsistente">
                        <td>12</td>
                        <td>11234</td>
                        <td>Aline Mendes</td>
                        <td>Feminino</td>
                        <td>654.123.987-00</td>
                        <td>Inconsistente</td>
                    </tr>
                    <tr data-status="consistente">
                        <td>13</td>
                        <td>22345</td>
                        <td>Joana Oliveira</td>
                        <td>Feminino</td>
                        <td>789.654.123-00</td>
                        <td>Consistente</td>
                    </tr>
                    <tr data-status="inconsistente">
                        <td>14</td>
                        <td>33456</td>
                        <td>Roberto Moreira</td>
                        <td>Masculino</td>
                        <td>321.456.789-00</td>
                        <td>Inconsistente</td>
                    </tr>
                    <tr data-status="consistente">
                        <td>15</td>
                        <td>44567</td>
                        <td>Gabriela Silva</td>
                        <td>Feminino</td>
                        <td>987.654.321-00</td>
                        <td>Consistente</td>
                    </tr>
                    <!-- Mais dados da tabela aqui -->
                </tbody>
            </table>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.16.9/dist/xlsx.full.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script>
        // Função de Exportar para Excel
        document.getElementById('exportBtn').addEventListener('click', function () {
            let table = document.querySelector('table');
            let wb = XLSX.utils.table_to_book(table, {sheet: "Sheet JS"});
            XLSX.writeFile(wb, 'dados.xlsx');
        });

        // Filtro de status
        document.getElementById('statusFilter').addEventListener('change', function () {
            let selectedStatus = this.value;
            let rows = document.querySelectorAll('#dataTable tr');
            rows.forEach(row => {
                let status = row.getAttribute('data-status');
                if (selectedStatus === 'todos' || status === selectedStatus) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        });

        // Função para importar arquivo Excel (leitura)
        document.getElementById('importBtn').addEventListener('click', function () {
            let input = document.createElement('input');
            input.type = 'file';
            input.accept = '.xlsx, .xls';
            input.onchange = function (event) {
                let file = event.target.files[0];
                let reader = new FileReader();
                reader.onload = function (e) {
                    let data = new Uint8Array(e.target.result);
                    let workbook = XLSX.read(data, {type: 'array'});
                    let firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    let jsonData = XLSX.utils.sheet_to_json(firstSheet, {header: 1});
                    console.log(jsonData); // Processa os dados importados
                };
                reader.readAsArrayBuffer(file);
            };
            input.click();
        });

        // Adicionar evento de clique para destacar a linha clicada
        let rows = document.querySelectorAll('#dataTable tr');
        rows.forEach(row => {
            row.addEventListener('click', function () {
                // Remover a classe "active" de todas as linhas
                rows.forEach(r => r.classList.remove('active'));
                // Adicionar a classe "active" à linha clicada
                this.classList.add('active');
            });
        });
    </script>
</body>
</html>
